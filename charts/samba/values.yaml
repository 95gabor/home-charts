# Default values for samba.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# -- Number of replicas for the Samba deployment
replicaCount: 1

# -- Image configuration for Samba Time Machine
# @default -- See `values.yaml`
image:
  # -- Container image repository for Samba Time Machine
  repository: mbentley/timemachine
  # -- Image pull policy (IfNotPresent, Always, Never)
  pullPolicy: IfNotPresent
  # -- Container image tag (overrides chart appVersion if set)
  # @default -- empty
  tag: ""

# -- Image pull secrets for private registries
imagePullSecrets: []
# -- Override the name of the chart
# @default -- empty
nameOverride: ""
# -- Override the full name of the chart
# @default -- empty
fullnameOverride: ""

# -- Pod annotations (metadata attached to pods)
podAnnotations: {}
# -- Pod labels (metadata for pod selection and organization)
podLabels: {}

# -- Pod security context (applies to all containers in the pod)
podSecurityContext: {}
  # fsGroup: 2000

# -- Security context for the container (applies to the main container)
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

# -- Use host network for the pod
hostNetwork: true

# -- DNS policy for pods
dnsPolicy: "ClusterFirst"

# -- DNS configuration for pods
dnsConfig: {}

# -- Termination grace period in seconds
# @default -- empty
terminationGracePeriodSeconds: ""

# -- Service configuration
# @default -- See `values.yaml`
service:
  # -- Kubernetes service type (ClusterIP, NodePort, LoadBalancer)
  type: ClusterIP
  # -- External traffic policy (Local, Cluster) - Only valid for LoadBalancer and NodePort services
  # Preserves source IP address when set to Local. Requires health checks on all nodes.
  # @default -- empty
  externalTrafficPolicy: ""
  # -- Service ports configuration
  # @default -- See `values.yaml`
  ports:
    # -- NetBIOS Name Service port (TCP) - Used for NetBIOS name resolution
    tcp139: 139
    # -- NetBIOS Name Service port (UDP) - Used for NetBIOS name resolution
    udp137: 137
    # -- NetBIOS Datagram Service port (UDP) - Used for NetBIOS datagram service
    udp138: 138
    # -- SMB/CIFS port (TCP) - Main file sharing port for SMB protocol
    tcp445: 445

# -- Environment variables
# @default -- See `values.yaml`
env:
  # -- Advertised hostname for Time Machine
  # @default -- empty
  ADVERTISED_HOSTNAME: ""
  # -- Use custom SMB configuration
  CUSTOM_SMB_CONF: "false"
  # -- Use custom user configuration
  CUSTOM_USER: "false"
  # -- Debug level (0-10)
  DEBUG_LEVEL: "1"
  # -- Mimic Apple Time Capsule model
  MIMIC_MODEL: "TimeCapsule8,119"
  # -- External configuration file path
  # @default -- empty
  EXTERNAL_CONF: ""
  # -- Hide shares from network
  HIDE_SHARES: "no"
  # -- Time Machine username
  TM_USERNAME: "timemachine"
  # -- Time Machine group name
  TM_GROUPNAME: "timemachine"
  # -- Time Machine user ID
  TM_UID: "1000"
  # -- Time Machine group ID
  TM_GID: "1000"
  # -- Password for Time Machine access (CHANGE THIS!)
  # WARNING: This is a default password. You MUST change it in production!
  PASSWORD: "timemachine"
  # -- Set permissions on volume
  SET_PERMISSIONS: "false"
  # -- SMB share name
  SHARE_NAME: "TimeMachine"
  # -- Inherit permissions from volume
  SMB_INHERIT_PERMISSIONS: "no"
  # -- Use NFS ACLs
  SMB_NFS_ACES: "no"
  # -- SMB metadata handling
  SMB_METADATA: "stream"
  # -- SMB port
  SMB_PORT: "445"
  # -- SMB VFS objects
  SMB_VFS_OBJECTS: "fruit streams_xattr"
  # -- Volume size limit (0 = unlimited)
  VOLUME_SIZE_LIMIT: "0"
  # -- SMB workgroup name
  WORKGROUP: "WORKGROUP"

# -- Additional environment variables (for complex values like valueFrom)
# Use this for environment variables that need valueFrom or other complex structures
# @default -- empty
envExtra: []
  # Example:
  # - name: SECRET_KEY
  #   valueFrom:
  #     secretKeyRef:
  #       name: my-secret
  #       key: password

# -- Resource limits and requests
# @default -- See `values.yaml`
resources:
  # -- Resource limits
  # @default -- See `values.yaml`
  limits:
    # -- CPU limit for the container
    cpu: 500m
    # -- Memory limit for the container
    memory: 512Mi
  # -- Resource requests
  # @default -- See `values.yaml`
  requests:
    # -- CPU request for the container
    cpu: 100m
    # -- Memory request for the container
    memory: 128Mi

# -- Horizontal Pod Autoscaler configuration
# @default -- See `values.yaml`
autoscaling:
  # -- Enable Horizontal Pod Autoscaler to automatically scale pods based on metrics
  enabled: false
  # -- Minimum number of pod replicas to maintain
  minReplicas: 1
  # -- Maximum number of pod replicas allowed
  maxReplicas: 100
  # -- Target CPU utilization percentage for autoscaling (0-100)
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

# -- Node selector for pod placement (constrain pods to specific nodes)
nodeSelector: {}

# -- Tolerations for pod scheduling (allow pods to be scheduled on tainted nodes)
tolerations: []

# -- Affinity rules for pod scheduling (pod affinity/anti-affinity, node affinity)
affinity: {}

# -- Persistence configuration
# @default -- See `values.yaml`
persistence:
  # -- Storage class for PVC (empty = use default storage class)
  # @default -- empty
  storageClass: ""
  # -- Size of the persistent volume claim
  size: 500Gi
  # -- Access mode for the persistent volume (ReadWriteOnce, ReadWriteMany, ReadOnlyMany)
  accessMode: ReadWriteOnce

# -- Pod Disruption Budget configuration
# @default -- See `values.yaml`
podDisruptionBudget:
  # -- Enable Pod Disruption Budget to control pod evictions during disruptions
  enabled: false
  # -- Minimum number of available pods during disruptions (mutually exclusive with maxUnavailable)
  # @default -- empty
  minAvailable: ""
  # -- Maximum number of unavailable pods during disruptions (mutually exclusive with minAvailable)
  # @default -- empty
  maxUnavailable: ""

# -- Network Policy configuration
# @default -- See `values.yaml`
networkPolicy:
  # -- Enable Network Policy to control network traffic to/from pods
  enabled: false
  # -- Ingress rules defining allowed incoming traffic
  # @default -- empty
  ingress: []
  # Example:
  # - from:
  #   - namespaceSelector:
  #       matchLabels:
  #         name: ingress-nginx
  #   ports:
  #   - protocol: TCP
  #     port: 445
  #   - protocol: UDP
  #     port: 137
  # - from:
  #   - ipBlock:
  #       cidr: 192.168.0.0/16
  #   ports:
  #   - protocol: TCP
  #     port: 445
  # -- Egress rules defining allowed outgoing traffic
  # @default -- empty
  egress: []
  # Example:
  # - to:
  #   - namespaceSelector:
  #       matchLabels:
  #         name: dns
  #   ports:
  #   - protocol: UDP
  #     port: 53
